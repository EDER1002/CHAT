<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark_Chat</title>
    <style>
        body {
            margin: 0;
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            background: url('https://upload.wikimedia.org/wikipedia/it/d/d3/Colline_%28immagine%29.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: center;
            background-size: cover;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .chat-container {
            width: 100%;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.8);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            border: 1px solid #555;
            background-color: #1a1a1a;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            height: 400px;
            font-size: 14px;
            text-align: left;
            color: #c0c0c0;
            scrollbar-width: thin;
            scrollbar-color: #888 #333;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        .chat-messages::-webkit-scrollbar-track {
            background: #333;
            border-radius: 10px;
        }
        .chat-messages::-webkit-scrollbar-thumb {
            background-color: #888;
            border-radius: 10px;
            border: 2px solid #333;
        }

        .chat-input-area {
            display: flex;
            margin-top: 10px;
        }

        .chat-input-area input[type="text"] {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #2a2a2a;
            color: #e0e0e0;
            font-size: 16px;
            margin-right: 10px;
            outline: none;
        }

        .chat-send-btn {
            padding: 10px 18px;
            background: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 7px;
            font-size: 16px;
            font-family: 'Arial Black', Arial, sans-serif;
            cursor: pointer;
            box-shadow: 0 2px 6px #0006;
            transition: background 0.2s, transform 0.15s;
        }
        .chat-send-btn:hover {
            background: #45a049;
            transform: translateY(-2px) scale(1.04);
        }

        .emoji-btn {
            margin-right: 8px;
            background: #333;
            color: #FFD700;
            font-size: 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        .emoji-btn:hover {
            background: #555;
        }

        #emojiPicker {
            display: none;
            position: absolute;
            bottom: 70px;
            left: 30px;
            z-index: 300;
            background: #222;
            border: 2px solid #FFD700;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 4px 16px #000a;
            max-width: 320px;
            max-height: 180px;
            overflow-y: auto;
            font-size: 22px;
            text-align: left;
        }
        #emojiPicker.emoji-show {
            display: block !important;
            animation: emojiFadeIn 0.25s cubic-bezier(.4,1.6,.6,1) both;
        }
        #emojiPicker.emoji-hide {
            animation: emojiFadeIn 0.2s reverse both;
        }

        @keyframes emojiFadeIn {
            0% { opacity: 0; transform: scale(0.8) translateY(30px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .message {
            margin-bottom: 8px;
            word-wrap: break-word;
            display: flex;
            align-items: flex-start;
        }

        .message .avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            border: 1px solid #777;
            flex-shrink: 0;
        }

        .message .message-content {
            flex-grow: 1;
        }

        .message strong {
            color: #FFD700;
            margin-right: 5px;
        }

        .message-appear {
            animation: messageFadeIn 0.5s cubic-bezier(.4,1.6,.6,1);
        }
        @keyframes messageFadeIn {
            0% { opacity: 0; transform: translateY(30px) scale(0.97); }
            80% { opacity: 1; transform: translateY(-4px) scale(1.01); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .chat-input-area input[type="text"]:focus {
            box-shadow: 0 0 8px 2px #4CAF50cc, 0 0 0 2px #222 inset;
            border-color: #4CAF50;
            transition: box-shadow 0.2s, border-color 0.2s;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
            <!-- Mensajes del chat se aÃ±adirÃ¡n aquÃ­ -->
            <div class="message">
                <img src="https://i.pinimg.com/736x/df/49/43/df4943b4c5a15777d49ab1eef7f1a2a8.jpg" class="avatar" alt="System Avatar">
                <div class="message-content">
                    <strong>System:</strong> Â¡Bienvenido al chat! Escribe un mensaje y usa emojis.
                </div>
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="Escribe tu mensaje...">
            <button type="button" id="emojiBtn" class="emoji-btn" title="Emojis">ðŸ˜Š</button>
            <button class="chat-send-btn" onclick="sendMessage()">Enviar</button>
        </div>
        <!-- Picker de emojis -->
        <div id="emojiPicker"></div>
    </div>

    <script>
        let username = "Usuario"; // Nombre de usuario por defecto
        let avatarUrl = "https://i.pinimg.com/736x/df/49/43/df4943b4c5a15777d49ab1eef7f1a2a8.jpg"; // Avatar por defecto

        // --- DRAGGABLE CHAT PANEL ---
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let initialX = 0;
        let initialY = 0;

        const chatContainer = document.querySelector('.chat-container');

        chatContainer.addEventListener('mousedown', function(e) {
            // No iniciar drag si el click es en el input o botones
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON' || e.target.closest('.chat-input-area')) {
                return;
            }
            isDragging = true;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            const rect = chatContainer.getBoundingClientRect();
            initialX = rect.left;
            initialY = rect.top;
            chatContainer.style.cursor = 'grabbing';
            e.preventDefault();
        });

        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;
            const dx = e.clientX - dragStartX;
            const dy = e.clientY - dragStartY;
            chatContainer.style.left = (initialX + dx) + 'px';
            chatContainer.style.top = (initialY + dy) + 'px';
            chatContainer.style.position = 'absolute';
        });

        document.addEventListener('mouseup', function() {
            if (isDragging) {
                isDragging = false;
                chatContainer.style.cursor = 'grab';
            }
        });

        // Set initial cursor
        chatContainer.style.cursor = 'grab';

        // FunciÃ³n para enviar mensaje
        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');
            const messageText = chatInput.value.trim();

            // Comando para borrar todo el chat
            if (messageText === '/delete.chat.admin') {
                // Limpiar todos los mensajes excepto el de bienvenida si quieres, o todos
                while (chatMessages.children.length > 0) {
                    chatMessages.removeChild(chatMessages.lastChild);
                }
                // Agregar mensaje de confirmaciÃ³n
                const systemMessage = document.createElement('div');
                systemMessage.classList.add('message');
                systemMessage.innerHTML = `<img src="https://i.pinimg.com/736x/df/49/43/df4943b4c5a15777d49ab1eef7f1a2a8.jpg" class="avatar" alt="System Avatar">
                    <div class="message-content">
                        <strong>System:</strong> Chat borrado por administrador.
                    </div>`;
                chatMessages.appendChild(systemMessage);
                chatInput.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight;
                return;
            }

            if (messageText === '') return;

            const newMessage = document.createElement('div');
            newMessage.classList.add('message', 'message-appear');
            newMessage.innerHTML = `<img src="${avatarUrl}" class="avatar" alt="${username} Avatar">
                <div class="message-content">
                    <strong>${username}:</strong> ${messageText}
                </div>`;
            chatMessages.appendChild(newMessage);

            // Remover la animaciÃ³n despuÃ©s de que termine
            newMessage.addEventListener('animationend', function handler() {
                newMessage.classList.remove('message-appear');
                newMessage.removeEventListener('animationend', handler);
            });

            chatInput.value = '';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Permitir enviar mensajes con Enter
        document.getElementById('chatInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });

        // --- EMOJI PICKER ---
        const emojiBtn = document.getElementById('emojiBtn');
        const emojiPicker = document.getElementById('emojiPicker');
        let emojiPickerVisible = false;

        // Poblar el picker de emojis
        function populateEmojiPicker() {
            if (!emojiPicker) return;
            const emojis = [
                'ðŸ˜€','ðŸ˜','ðŸ˜‚','ðŸ¤£','ðŸ˜ƒ','ðŸ˜„','ðŸ˜…','ðŸ˜†','ðŸ˜‰','ðŸ˜Š','ðŸ˜‹','ðŸ˜Ž','ðŸ˜','ðŸ˜˜','ðŸ¥°','ðŸ˜—','ðŸ˜™','ðŸ˜š','ðŸ™‚','ðŸ¤—',
                'ðŸ¤©','ðŸ¤”','ðŸ¤¨','ðŸ˜','ðŸ˜‘','ðŸ˜¶','ðŸ™„','ðŸ˜','ðŸ˜£','ðŸ˜¥','ðŸ˜®','ðŸ¤','ðŸ˜¯','ðŸ˜ª','ðŸ˜«','ðŸ¥±','ðŸ˜´','ðŸ˜Œ','ðŸ˜›','ðŸ˜œ',
                'ðŸ˜','ðŸ¤¤','ðŸ˜’','ðŸ˜“','ðŸ˜”','ðŸ˜•','ðŸ™ƒ','ðŸ¤‘','ðŸ˜²','â˜¹ï¸','ðŸ™','ðŸ˜–','ðŸ˜ž','ðŸ˜Ÿ','ðŸ˜¤','ðŸ˜¢','ðŸ˜­','ðŸ˜¦','ðŸ˜§','ðŸ˜¨',
                'ðŸ˜©','ðŸ¤¯','ðŸ˜¬','ðŸ˜°','ðŸ˜±','ðŸ¥µ','ðŸ¥¶','ðŸ˜³','ðŸ¤ª','ðŸ˜µ','ðŸ¥´','ðŸ˜ ','ðŸ˜¡','ðŸ¤¬','ðŸ˜·','ðŸ¤’','ðŸ¤•','ðŸ¤¢','ðŸ¤®','ðŸ¥³',
                'ðŸ˜‡','ðŸ¥º','ðŸ˜ˆ','ðŸ‘¿','ðŸ‘¹','ðŸ‘º','ðŸ’€','ðŸ‘»','ðŸ‘½','ðŸ¤–','ðŸ’©','ðŸ˜º','ðŸ˜¸','ðŸ˜¹','ðŸ˜»','ðŸ˜¼','ðŸ˜½','ðŸ™€','ðŸ˜¿','ðŸ˜¾',
                'ðŸ‘','ðŸ‘Ž','ðŸ‘Œ','âœŒï¸','ðŸ¤ž','ðŸ¤Ÿ','ðŸ¤˜','ðŸ¤™','ðŸ––','ðŸ‘‹','ðŸ¤š','ðŸ–ï¸','âœ‹','ðŸ––','ðŸ‘','ðŸ™Œ','ðŸ‘','ðŸ¤²','ðŸ™','ðŸ’ª',
                'ðŸ‘€','ðŸ‘ï¸','ðŸ‘…','ðŸ‘„','ðŸ’‹','ðŸ’˜','ðŸ’','ðŸ’–','ðŸ’—','ðŸ’“','ðŸ’ž','ðŸ’•','ðŸ’Ÿ','â£ï¸','ðŸ’”','â¤ï¸','ðŸ§¡','ðŸ’›','ðŸ’š','ðŸ’™',
                'ðŸ’œ','ðŸ–¤','ðŸ¤','ðŸ¤Ž','ðŸ’¯','ðŸ’¢','ðŸ’¥','ðŸ’«','ðŸ’¦','ðŸ’¨','ðŸ•³ï¸','ðŸ’£','ðŸ’¬','ðŸ‘“','ðŸ•¶ï¸','ðŸŽµ','ðŸŽ¶','ðŸŽ¤','ðŸŽ§','ðŸŽ¸',
                'ðŸ¥','ðŸŽ·','ðŸŽº','ðŸŽ»','ðŸŽ¹','ðŸª—','ðŸª•','ðŸŽ¼','ðŸŽ¤','ðŸŽ¬','ðŸŽ®','ðŸ•¹ï¸','ðŸŽ²','ðŸŽ¯','ðŸŽ³','ðŸŽ°','ðŸ§©','ðŸ§¸','ðŸª','ðŸª€',
                'ðŸ†','ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰','ðŸ…','ðŸŽ–ï¸','ðŸµï¸','ðŸŽ—ï¸','ðŸŽ«','ðŸŽŸï¸','ðŸŽª','ðŸ¤¹','ðŸ¤¹â€â™‚ï¸','ðŸ¤¹â€â™€ï¸','ðŸ§™â€â™‚ï¸','ðŸ§™â€â™€ï¸','ðŸ§›â€â™‚ï¸','ðŸ§›â€â™€ï¸','ðŸ§Ÿâ€â™‚ï¸','ðŸ§Ÿâ€â™€ï¸'
            ];
            emojiPicker.innerHTML = '';
            const grid = document.createElement('div');
            grid.style.display = 'grid';
            grid.style.gridTemplateColumns = 'repeat(10, 1fr)';
            grid.style.gap = '6px';
            grid.style.maxWidth = '300px';
            grid.style.maxHeight = '150px';
            grid.style.overflowY = 'auto';
            emojis.forEach(emoji => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.textContent = emoji;
                btn.style.fontSize = '22px';
                btn.style.background = 'none';
                btn.style.border = 'none';
                btn.style.cursor = 'pointer';
                btn.style.transition = 'transform 0.1s';
                btn.style.borderRadius = '5px';
                btn.style.padding = '2px';
                btn.onmouseover = () => btn.style.transform = 'scale(1.25)';
                btn.onmouseout = () => btn.style.transform = 'scale(1)';
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    insertEmojiAtCursor(emoji);
                });
                grid.appendChild(btn);
            });
            emojiPicker.appendChild(grid);
        }

        // Insertar emoji en el input en la posiciÃ³n del cursor
        function insertEmojiAtCursor(emoji) {
            const input = document.getElementById('chatInput');
            if (!input) return;
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const value = input.value;
            input.value = value.slice(0, start) + emoji + value.slice(end);
            // Mover el cursor despuÃ©s del emoji
            input.selectionStart = input.selectionEnd = start + emoji.length;
            input.focus();
        }

        if (emojiBtn && emojiPicker) {
            populateEmojiPicker();
            emojiBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                if (!emojiPickerVisible) {
                    emojiPicker.classList.remove('emoji-hide');
                    emojiPicker.style.display = 'block';
                    void emojiPicker.offsetWidth;
                    emojiPicker.classList.add('emoji-show');
                    emojiPickerVisible = true;
                } else {
                    emojiPicker.classList.remove('emoji-show');
                    emojiPicker.classList.add('emoji-hide');
                    emojiPicker.addEventListener('animationend', function handler() {
                        if (!emojiPickerVisible) emojiPicker.style.display = 'none';
                        emojiPicker.removeEventListener('animationend', handler);
                    });
                    emojiPickerVisible = false;
                }
            });
            // Ocultar el picker si se hace clic fuera
            document.addEventListener('click', function(e) {
                if (emojiPickerVisible && !emojiPicker.contains(e.target) && e.target !== emojiBtn) {
                    emojiPicker.classList.remove('emoji-show');
                    emojiPicker.classList.add('emoji-hide');
                    emojiPicker.addEventListener('animationend', function handler() {
                        if (!emojiPickerVisible) emojiPicker.style.display = 'none';
                        emojiPicker.removeEventListener('animationend', handler);
                    });
                    emojiPickerVisible = false;
                }
            });
        }
    </script>
</body>
</html>
